{% load static %}
{% load profile_img_tag %}
<link rel="stylesheet" type="text/css" href="{% static 'css/post-page.css' %}">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<div class="postpopup">
<div class="content-container">
    <div class="content-head">
        <div>
            <a href="{% url 'profile' post.author.user.id %}"><img src="{{post.author.profile_img.url}}"></a>
        </div>
        <a href="{% url 'profile' post.author.user.id %}">
            <div class="user-name">
                <span>{{post.author.user.first_name}} {{post.author.user.last_name}}</span>
                <span>@{{post.author.user.username}}</span>
            </div>
        </a>
        <div>
            <h6>{{post.created | date:"d, M/y"}}</h6>
        </div> 
        <div class="content-genres">
            {% for genre in post.genres.all %}
            <img loading="lazy" src="{{genre.genre_img.url}}" alt="{{genre.name}}" title="{{genre.name}}"> 
          {% endfor %}
        </div>

    </div>

    <div class="content-title">
            <textarea readonly id="context-title">{{post.post_title}}</textarea>
    </div>

    <div class="content-body">
        <textarea name="" id="postText">{{post.text_body}}</textarea>
    </div>
    <div class="postImage">
        <img loading="lazy" src="{{post.image.url}}" alt="">
        <button data-post-id="{{post.id}}" id="post-like-button">
            {% if is_liked %}
            <svg id="heart-svg" xmlns="http://www.w3.org/2000/svg" fill="red" height="70" viewBox="0 96 960 960" width="70">
                <path d="M479 963.5 423 913q-107.766-99.072-177.919-171.093-70.152-72.021-111.901-128.866-41.749-56.844-57.964-103.916Q59 462.053 59 413.5q0-99.505 66.498-166.502Q191.995 180 290.5 180q55.288 0 103.144 24Q441.5 228 479 275.5q44-50 89.185-72.75Q613.371 180 667.629 180q99.38 0 166.376 66.943Q901 313.886 901 413.308q0 48.73-16.216 95.309-16.215 46.58-57.964 103.424-41.749 56.845-112.401 129.366Q643.766 813.928 536 913l-57 50.5Z"/>
            </svg>
            {% else %}
            <svg id="heart-svg" xmlns="http://www.w3.org/2000/svg" fill="grey" height="70" viewBox="0 96 960 960" width="70">
                <path d="M479 963.5 423 913q-107.766-99.072-177.919-171.093-70.152-72.021-111.901-128.866-41.749-56.844-57.964-103.916Q59 462.053 59 413.5q0-99.505 66.498-166.502Q191.995 180 290.5 180q55.288 0 103.144 24Q441.5 228 479 275.5q44-50 89.185-72.75Q613.371 180 667.629 180q99.38 0 166.376 66.943Q901 313.886 901 413.308q0 48.73-16.216 95.309-16.215 46.58-57.964 103.424-41.749 56.845-112.401 129.366Q643.766 813.928 536 913l-57 50.5Z"/>
            </svg>
            {% endif %}
        </button>
    </div>
    <div class="comments-container">
        <div class="make-comment">
            <form method="POST" action="{% url 'add_comment' %}">
                {% csrf_token %}
                <input type="hidden" name="post_id" value="{{post.id}}">
                <input type="text" name="comment" required placeholder="Make a comment">
                <button type="sumbit"><img src="{% static 'default-img/icons/feather-solid.svg' %}"></button>
            </form>
        </div>
        {% for comment in comments %}
        <div class="comments-section">
            <div class="comment">
                <p name="comment">{{comment.text}}</p>
                <div class="comment-foot">
                    <a href="{% url 'profile' comment.user.id %}"><img src="{% profile_img comment.user.id %}"></a>
                    <a href="{% url 'profile' comment.user.id %}">
                        <div class="comment-info">
                            <span>{{comment.created_at | date:"d, M/y"}}</span>
                            <span>{{comment.user.first_name}} {{comment.user.last_name}} | @{{comment.user.username}}</span>
                        </div>
                    </a>
                    <span href="#" type="submit" class="open-delete" onclick="deleteModal({value1:'{{post.id}}', value2:'{{post.post_title}}', value3:'{{csrf_token}}'})">
                        <img src="{% static 'default-img/remove.png' %}"></span>
                </div>
            </div>

        </div>
        {% endfor %}
    </div>

</div>
</div>
<script src="/static/js/post-page.js"></script>